---
title: "Process"
---

#### Importing necessary packages for this project:  

About the *learningtower* package:  
The Programme for International Student Assessment (PISA) is a global study conducted by the Organization for Economic Cooperation and Development (OECD) in member and non-member countries to assess educational systems by assessing 15-year-old school students academic performance in mathematics, science, and reading. This datasets contains information on their scores and other socioeconomic characteristics, information about their school and its infrastructure, as well as the countries that are taking part in the program.

```{r message=FALSE}
library(learningtower)
```

About the *dplyr* package:  
A fast, consistent tool for working with data frame like objects, both in memory and out of memory.
```{r message=FALSE}
library(dplyr)
```

About the *tidyr* package:  
Tools to help to create tidy data, where each column is a variable, each row is an observation, and each cell contains a single value. 'tidyr' contains tools for changing the shape (pivoting) and hierarchy (nesting and 'unnesting') of a dataset, turning deeply nested lists into rectangular data frames ('rectangling'), and extracting values out of string columns. It also includes tools for working with missing values (both implicit and explicit).
```{r message=FALSE}
library(tidyr)
```

About the *reactable* package:  
Interactive data tables for R, based on the 'React Table' JavaScript library. Provides an HTML widget that can be used in 'R Markdown' documents and 'Shiny' applications, or viewed from an R console.
```{r message=FALSE}
library(reactable)
```

```{r message=FALSE}
library(writexl)
library(factoextra)
```

###### *Do note that some of the rows are omitted due to the sheer size of the data frame*

#### Loading PISA 2018 result dataset  

```{r message=FALSE}
# We'll be naming the data frame stud_perf_2018
stud_perf_2018 <- load_student(2018)
# Since we only wanted to grab the PISA 2018 result we passed 2018 as argument to the load_student function provided by the learningtower package
```

#### Here's a table view of the entire PISA 2018 dataset:
```{r}
# RESERVED FOR FINAL
# DO NOT UNCOMMENT YET!
# reactable(stud_perf_2018)

stud_perf_2018
```

#### Here's some information about the dataset
```{r}
# The class of our data
class(stud_perf_2018)

# Total number of rows and columns in the stud_perf_2018 dataset
dim(stud_perf_2018)
```

#### Here's the different columns in the dataset
```{r}
table(colnames(stud_perf_2018))
```

#### Here's the overall summary statistic for all the columns in stud_perf_2018 dataset:
```{r}
# Assigning some variables
overall_sum <- summary(stud_perf_2018)
math_sum <- summary(stud_perf_2018$math)
science_sum <- summary(stud_perf_2018$science)

# Overall
overall_sum
```

#### Math and Science statistic summaries:
```{r}
# Mathematics
math_sum

# Science
science_sum
```
  
## Visual Exploratory Analysis
***

#### Extracting math and science scores and assigning them in variables math_perf_2018 and sci_perf_2018
```{r}
math_perf_2018 <- stud_perf_2018$math
sci_perf_2018 <- stud_perf_2018$science
```


#### Histogram: Math
```{r}
hist(math_perf_2018)
```

#### Histogram: Science
```{r}
hist(sci_perf_2018)
```


### RESULT: Normal distribution for both Math and Science performance

***

#### Boxplot: Math
```{r}
boxplot(math_perf_2018)
```

#### Boxplot: Science
```{r}
boxplot(sci_perf_2018)
```

***

## Data Cleaning

#### TODO:
- [x] Rename all columns in the data to UPPERCASE
- [x] Remove all missing values from nominal variables
- [x] Remove the ```read``` column
- [x] Recompute the ```stu_wgt``` column with ```read``` column removed


<br />


# Separating Student Profile and Student Performance

### Cleaning Student's Profile:
Getting only significant columns from the data-set

```{r message=FALSE}
 ID<-stud_perf_2018$student_id
 GENDER<-stud_perf_2018$gender
 COUNTRY<-stud_perf_2018$country
 SCHOOL<-stud_perf_2018$school_id
 N_COMPUTER<-stud_perf_2018$computer_n
 N_TV<-stud_perf_2018$television
 HAS_COMPUTER<-stud_perf_2018$computer
 HAS_DESK<-stud_perf_2018$desk
 HAS_DISHWASHER<-stud_perf_2018$dishwasher
 HAS_ROOM<-stud_perf_2018$room
 HAS_INTERNET<-stud_perf_2018$internet
 EDU_MOTHER<-stud_perf_2018$mother_educ
 EDU_FATHER<-stud_perf_2018$father_educ
 MATH <- stud_perf_2018$math
 SCIENCE <- stud_perf_2018$science
 WEALTH <- stud_perf_2018$wealth
 
 
 
 # Building student_profile dataframe
 
 student_profile = data.frame(
   ID,
   GENDER,
   COUNTRY,
   SCHOOL,
   N_COMPUTER,
   N_TV,
   HAS_ROOM,
   HAS_DESK,
   HAS_COMPUTER,
   HAS_INTERNET,
   EDU_FATHER,
   EDU_MOTHER,
   WEALTH
   )
 
 student_grades = data.frame(
   ID,
   COUNTRY,
   WEALTH,
   N_COMPUTER,
   MATH,
   SCIENCE
 )
 
 # Eliminate rows with missing values from the entire student_profile dataframe and creating a new data frame
 
 clean_df<-na.omit(student_profile)
 clean_grade_df<-na.omit(student_grades)
 
 # It is important to note that we removed the HAS_DISHWASHER column since it basically had nothing but padded NA values so we didn't include it in the new student_profile
 
 # Student Profile Table
 # reactable(clean_df)
 # Student Grades
 # reactable(clean_grade_df)
 
 
 # Summarizing new clean_student_profile data frame
 
gender_sum <- summary(clean_df$GENDER)
computer_sum <-summary(clean_df$N_COMPUTER)
tv_sum <- summary(clean_df$N_TV)
h_room_sum <- summary(clean_df$HAS_ROOM)
h_desk_sum <- summary(clean_df$HAS_DESK)
h_computer_sum <- summary(clean_df$HAS_COMPUTER)
h_internet_sum <- summary(clean_df$HAS_INTERNET)
father_sum <- summary(clean_df$EDU_FATHER)
mother_sum <- summary(clean_df$EDU_MOTHER)
wealth_sum <- summary(clean_df$WEALTH)
 
 # Output:

gender_sum
computer_sum
tv_sum
h_room_sum
h_desk_sum
h_computer_sum
h_internet_sum
father_sum
mother_sum
 
```

## Setting up for K-Means Algorithm Testing

```{r message=FALSE}
# Initializing Data
# Random sampling of Data from clean_grade dataframe
# Since my computer couldn't handle 500k+ data
sampled_clean_grade_df <- sample_n(clean_grade_df, 100)
hist(sampled_clean_grade_df$MATH)
sampled_clean_grade_df.MATH <- sampled_clean_grade_df$MATH
table(sampled_clean_grade_df.MATH)

# Excluding Factor observations
grade_data <- sampled_clean_grade_df[5:6]

# Scaling Data
grade_data_scale <- scale(grade_data)

# Calculating Distance (Euclidean)
grade_data <- dist(grade_data_scale)

# Calculating number of Clusters needed
fviz_nbclust(grade_data_scale, kmeans, method="wss") + labs(subtitle = "Elbow method")

```

## K-Means Algorithm Testing
```{r}

km.out <- kmeans(grade_data_scale, centers = 3, nstart = 100)
print(km.out)

km.clusters <- km.out$cluster
rownames(grade_data_scale) <- paste(sampled_clean_grade_df$COUNTRY, 1:dim(sampled_clean_grade_df)[1], sep = '_')

# Visualizing the Cluster
fviz_cluster(list(data=grade_data_scale, cluster = km.clusters))

```
